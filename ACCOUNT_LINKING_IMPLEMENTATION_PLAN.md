# ๐๏ธ ูุธุงู ุงูุฑุจุท ุงูุชููุงุฆู ุงูุดุงูู - ุฎุทุฉ ุงูุชูููุฐ ุงููุงููุฉ

## ๐ ุงูููุฎุต ุงูุชูููุฐู

ุชู ุชุตููู **ูุธุงู ุงูุฑุจุท ุงูุชููุงุฆู ุงูุดุงูู** ูุฑุจุท ุฌููุน ููุงูุงุช ุงููุธุงู (ุงูุนููุงุกุ ุงูููุฑุฏููุ ุงููุฎุงุฒูุ ุงูุจูููุ ุงููุฑูุน) ุจุฏููู ุงูุญุณุงุจุงุช ุงููุญุงุณุจู ุชููุงุฆูุงูุ ูุน ุถูุงู ุงููุฒุงููุฉ ุงููุณุชูุฑุฉ ูุงูุฏูุฉ ุงููุญุงุณุจูุฉ.

## ๐ฏ ุงูุฃูุฏุงู ุงูุฑุฆูุณูุฉ

1. **ุงูุฑุจุท ุงูุชููุงุฆู**: ุฅูุดุงุก ุญุณุงุจ ูุญุงุณุจู ุชููุงุฆูุงู ููู ููุงู ุฌุฏูุฏ
2. **ุงููุฒุงููุฉ ุงูููุฑูุฉ**: ุชุญุฏูุซ ุจูุงูุงุช ุงูุญุณุงุจ ุนูุฏ ุชุบููุฑ ุจูุงูุงุช ุงูููุงู
3. **ุงููููู ุงูููุธู**: ุชูุธูู ุงูุญุณุงุจุงุช ูู ูููู ุดุฌุฑู ูุงุถุญ
4. **ุงููุฑููุฉ**: ุฅููุงููุฉ ุฅุถุงูุฉ ููุงูุงุช ุฌุฏูุฏุฉ ุจุณูููุฉ
5. **ุงูููุซูููุฉ**: ุถูุงู ุณูุงูุฉ ุงูุจูุงูุงุช ูุงูุนูููุงุช

## ๐๏ธ ุงููููู ุงูุชููู

### 1. ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### A) ุงูุฌุฏูู ุงููุฑูุฒู `accountable_accounts`

```sql
- id (Primary Key)
- account_id (FK โ accounts.id)
- accountable_type (Customer, Supplier, etc.)
- accountable_id (ID of linked entity)
- auto_created (boolean)
- sync_settings (JSON)
- last_sync_at (timestamp)
- created_at, updated_at
```

#### B) ุฅุถุงูุงุช ููุฌุฏุงูู ุงูุญุงููุฉ

```sql
ALTER TABLE customers ADD COLUMN account_id BIGINT UNSIGNED NULL;
ALTER TABLE suppliers ADD COLUMN account_id BIGINT UNSIGNED NULL;
ALTER TABLE warehouses ADD COLUMN account_id BIGINT UNSIGNED NULL;
ALTER TABLE banks ADD COLUMN account_id BIGINT UNSIGNED NULL;
```

### 2. ุงููููู ุงููุญุงุณุจู ุงูููุชุฑุญ

```
๐ ุฏููู ุงูุญุณุงุจุงุช
โโโ ๐ฐ ุงูุฃุตูู (Assets)
โ   โโโ ๐ฅ ุงูุนููุงุก (Customers) [Title]
โ   โ   โโโ ๐ค ุนููุงุก ุฃูุฑุงุฏ [Account]
โ   โ   โ   โโโ ๐ธ ุฃุญูุฏ ูุญูุฏ ุนูู [Sub-Account]
โ   โ   โ   โโโ ๐ธ ุณุนุฏ ุงูุบุงูุฏู [Sub-Account]
โ   โ   โโโ ๐ข ุนููุงุก ุดุฑูุงุช [Account]
โ   โ       โโโ ๐ธ ุดุฑูุฉ ุงูุฑูุงุถ ููุชุฌุงุฑุฉ [Sub-Account]
โ   โ       โโโ ๐ธ ูุคุณุณุฉ ุฌุฏุฉ ุงูุชุฌุงุฑูุฉ [Sub-Account]
โ   โโโ ๐ช ุงููุฎุงุฒู (Warehouses) [Title]
โ   โ   โโโ ๐ฆ ูุฎุฒู ุงูุฑูุงุถ ุงูุฑุฆูุณู [Sub-Account]
โ   โ   โโโ ๐ฆ ูุฎุฒู ุฌุฏุฉ ุงููุฑุนู [Sub-Account]
โ   โโโ ๐ฆ ุงูุจููู ูุงูููุฏูุฉ (Banks) [Title]
โ       โโโ ๐ณ ุงูุจูู ุงูุฃููู - ุญุณุงุจ ุฌุงุฑู [Sub-Account]
โ       โโโ ๐ณ ุงูุฑุงุฌุญู - ุญุณุงุจ ุชูููุฑ [Sub-Account]
โโโ ๐ ุงูุฎุตูู (Liabilities)
    โโโ ๐ ุงูููุฑุฏูู (Suppliers) [Title]
        โโโ ๐ค ููุฑุฏูู ุฃูุฑุงุฏ [Account]
        โ   โโโ ๐ธ ูุคุณุณุฉ ุงูุฎููุฌ ููููุงุฏ [Sub-Account]
        โ   โโโ ๐ธ ูุชุฌุฑ ุงูุดุฑู [Sub-Account]
        โโโ ๐ข ููุฑุฏูู ุดุฑูุงุช [Account]
            โโโ ๐ธ ุงูุดุฑูุฉ ุงูุณุนูุฏูุฉ ููุฃุบุฐูุฉ [Sub-Account]
            โโโ ๐ธ ูุฌููุนุฉ ุงูุฏุงููุจ [Sub-Account]
```

## ๐ ุงููููุงุช ุงููุทููุจุฉ

### โ ุชู ุฅูุดุงุคูุง:

1. **`app/Services/AccountLinkingService.php`**

    - ุงูุฎุฏูุฉ ุงูุฑุฆูุณูุฉ ููุฑุจุท ูุงููุฒุงููุฉ
    - ุฅูุดุงุกุ ุชุญุฏูุซุ ุญุฐูุ ููุฒุงููุฉ ุงูุญุณุงุจุงุช
    - ุฏุนู ุงูุนูููุงุช ุงููุฌูุนุฉ (Bulk Operations)

2. **`app/Services/AccountStructureService.php`**

    - ุฅุฏุงุฑุฉ ูููู ุงูุญุณุงุจุงุช ุงูุฃุณุงุณู
    - ุฅูุดุงุก ุงูุญุณุงุจุงุช ุงูุฃุจ ูุงููุฑุนูุฉ
    - ูุญุต ูุฅุญุตุงุฆูุงุช ุงููููู

3. **`app/Models/AccountableAccount.php`**

    - ูููุฐุฌ ุงูุฌุฏูู ุงููุฑูุฒู ููุฑุจุท
    - ุนูุงูุงุช Polymorphic ูุน ุงูููุงูุงุช
    - Scopes ูAccessors ูููุฏุฉ

4. **`app/Traits/HasAccount.php`**

    - Trait ููููุงูุงุช ุงููุงุจูุฉ ููุฑุจุท
    - Methods ููุฑุจุท ูุงููุฒุงููุฉ ูุงููุญุต
    - Event Hooks ุชููุงุฆูุฉ

5. **`config/account_linking.php`**

    - ุฅุนุฏุงุฏุงุช ุงููุธุงู ุงูุดุงููุฉ
    - ุชูููู ุงูููุงูุงุช ูุฎุตุงุฆุตูุง
    - ูููู ุงูุญุณุงุจุงุช ุงููุทููุจ

6. **`database/migrations/2025_08_10_162004_create_accountable_accounts_table.php`**

    - Migration ููุฌุฏูู ุงููุฑูุฒู
    - Foreign Keys ูIndexes ูุญุณูุฉ

7. **`app/Console/Commands/SetupAccountLinking.php`**
    - ุฃูุฑ Artisan ููุฅุนุฏุงุฏ ูุงูุตูุงูุฉ
    - ูุงุฌูุฉ ุชูุงุนููุฉ ููุฅุฏุงุฑุฉ
    - ูุญุต ุงูุญุงูุฉ ูุชูุงุฑูุฑ ููุตูุฉ

### ๐ ุงููุทููุจ ุฅูุดุงุคูุง ูุงุญูุงู:

8. **Events & Listeners**

    - `EntityCreated`, `EntityUpdated`, `EntityDeleted`
    - `CreateAccountForEntity`, `SyncAccountWithEntity`

9. **Middleware ููุชุญูู**

    - `EnsureAccountExists`
    - `ValidateAccountLinking`

10. **API Resources**

    - `AccountLinkingResource`
    - `EntityAccountResource`

11. **ูุงุฌูุงุช ุงูุฅุฏุงุฑุฉ**
    - Account Linking Management Dashboard
    - Bulk Operations Interface
    - Sync Status Monitor

## ๐ ุฎุทุฉ ุงูุชุทุจูู

### ุงููุฑุญูุฉ ุงูุฃููู (Week 1) - ุงูุฃุณุงุณูุงุช โ

-   [x] ุฅูุดุงุก ุงูุฌุฏุงูู ูุงูููุงุฐุฌ ุงูุฃุณุงุณูุฉ
-   [x] ุชุทููุฑ ุฎุฏูุงุช ุงูุฑุจุท ุงูุฃุณุงุณูุฉ
-   [x] ุฅุนุฏุงุฏ ุงูุชูููู ูุงูุฃูุงูุฑ
-   [ ] ุชุดุบูู Migration ูุฅูุดุงุก ุงููููู ุงูุฃุณุงุณู

### ุงููุฑุญูุฉ ุงูุซุงููุฉ (Week 2) - ุงูุชุทุจูู ุนูู ุงูุนููุงุก

-   [ ] ุชุทุจูู HasAccount Trait ุนูู Customer Model
-   [ ] ุฅูุดุงุก ุญุณุงุจุงุช ููุนููุงุก ุงูููุฌูุฏูู
-   [ ] ุชุญุฏูุซ CustomerService ููุฑุจุท ุงูุชููุงุฆู
-   [ ] ุงุฎุชุจุงุฑ ุงููุฒุงููุฉ ูุงูุชุญุฏูุซุงุช

### ุงููุฑุญูุฉ ุงูุซุงูุซุฉ (Week 3) - ุชูุณูุน ุงููุธุงู

-   [ ] ุชุทุจูู ุงููุธุงู ุนูู Suppliers
-   [ ] ุชุทุจูู ุงููุธุงู ุนูู Warehouses
-   [ ] ุชุทุจูู ุงููุธุงู ุนูู Banks
-   [ ] ุชุทููุฑ ูุงุฌูุงุช ุงูุฅุฏุงุฑุฉ

### ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉ (Week 4) - ุงูุชุญุณููุงุช ูุงูุงุณุชููุงู

-   [ ] ุฅุถุงูุฉ Events ูListeners
-   [ ] ุชุทููุฑ ุชูุงุฑูุฑ ุงูุฑุจุท
-   [ ] ุชุญุณููุงุช ุงูุฃุฏุงุก ูุงูุฃูุงู
-   [ ] ุงุฎุชุจุงุฑุงุช ุดุงููุฉ ููุซุงุฆู ุงููุณุชุฎุฏู

## โ๏ธ ุทุฑููุฉ ุงูุชุดุบูู

### 1. ุฅุนุฏุงุฏ ุงููุธุงู ุงูุฃุณุงุณู

```bash
# ุชุดุบูู Migration
php artisan migrate

# ุฅุนุฏุงุฏ ุงููุธุงู ุงููุงูู
php artisan account-linking:setup

# ุฃู ุจุฎุทูุงุช ูููุตูุฉ:
php artisan account-linking:setup --create-structure
php artisan account-linking:setup --link-existing
```

### 2. ูุญุต ุงูุญุงูุฉ

```bash
# ูุญุต ุญุงูุฉ ุงููุธุงู
php artisan account-linking:setup --check

# ุฑุจุท ููุงู ูุญุฏุฏ
php artisan account-linking:setup --link-existing --entity=Customer
```

### 3. ุงุณุชุฎุฏุงู ุงููุธุงู ูู ุงูููุฏ

```php
// ูู CustomerService ุฃู ุฃู ููุงู ุขุฎุฑ
use App\Traits\HasAccount;

class Customer extends Model
{
    use HasAccount;

    // ุจุงูู ุงูููุฏ...
}

// ุงูุงุณุชุฎุฏุงู
$customer = Customer::create($data);
$account = $customer->createAccount(); // ุฅูุดุงุก ุญุณุงุจ ุชููุงุฆู
$customer->syncWithAccount(); // ูุฒุงููุฉ ุงูุจูุงูุงุช
$status = $customer->getAccountLinkingStatus(); // ูุญุต ุงูุญุงูุฉ
```

## ๐ ุงููููุฒุงุช ุงููุชููุนุฉ

### ูููุณุชุฎุฏู

-   โ ุฑุจุท ุชููุงุฆู ููุฑู ุจูู ุงูููุงูุงุช ูุงูุญุณุงุจุงุช
-   โ ูุฒุงููุฉ ูุณุชูุฑุฉ ููุจูุงูุงุช ูุงูุฃุฑุตุฏุฉ
-   โ ูุงุฌูุฉ ููุญุฏุฉ ููุฅุฏุงุฑุฉ ูุงููุชุงุจุนุฉ
-   โ ุชูุงุฑูุฑ ุดุงููุฉ ูุฅุญุตุงุฆูุงุช ุฏูููุฉ

### ูููุทูุฑ

-   โ ูุธุงู ูุงุจู ููุชูุณุน ูุงูุชุฎุตูุต
-   โ API ููุญุฏ ูุซุงุจุช
-   โ Events System ูุฑู
-   โ ุฅุนุฏุงุฏุงุช ุดุงููุฉ ููุฑูุฒูุฉ

### ูููุธุงู

-   โ ุฃุฏุงุก ูุญุณู ูุน Eager Loading
-   โ ุนูููุงุช Batch ููุชุญุฏูุซุงุช
-   โ Logging ุดุงูู ูููุฑุงูุจุฉ
-   โ ุญูุงูุฉ ุงูุจูุงูุงุช ูุงููุณุฎ ุงูุงุญุชูุงุทู

## ๐ง ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ุชุดุบูู ุงูููููุงุช ุงูุฃุณุงุณูุฉ**:

    ```bash
    php artisan migrate
    php artisan account-linking:setup --full
    ```

2. **ุชุทุจูู ุนูู Customer Model**:

    - ุฅุถุงูุฉ `use HasAccount;`
    - ุชุญุฏูุซ CustomerService
    - ุงุฎุชุจุงุฑ ุงูุนูููุงุช

3. **ุชุทููุฑ ุงููุงุฌูุงุช**:

    - ููุญุฉ ุฅุฏุงุฑุฉ ุงูุฑุจุท
    - ูุฑุงูุจ ุญุงูุฉ ุงููุฒุงููุฉ
    - ุชูุงุฑูุฑ ููุตูุฉ

4. **ุงูุชูุณุน ููููุงูุงุช ุงูุฃุฎุฑู**:
    - Suppliers, Warehouses, Banks
    - Products/Categories (ุงุฎุชูุงุฑู)
    - ุฃู ููุงูุงุช ูุณุชูุจููุฉ

---

**ุงููุฏู ุงูููุงุฆู**: ูุธุงู ุฑุจุท ุดุงูู ูููุซูู ูููุฑ ุชูุงููุงู ุณูุณุงู ุจูู ุฌููุน ููุงูุงุช ERP ูุฏููู ุงูุญุณุงุจุงุช ุงููุญุงุณุจูุ ูุน ุถูุงู ุงูุฏูุฉ ูุงูุฃุฏุงุก ุงูุนุงูู.
